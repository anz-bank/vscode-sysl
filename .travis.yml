language: node_js
sudo: false
node_js:
- '10.0'
env:
  global:
  - secure: YMwuLOcfAbaljgqQBqSi/3KQJZEQJmYLwvkNs1JeaKdEm5ELkAf7MV4vl4YCosv594yL2nn+W40Q6cL51diKSTA0hCmdo49T0Ccz1H+Dky5Oqg6LHJxpNM+UszSD7yI9TXPcufi5lCQ8ZMQIYNzf8OpKnMsoHPf2WEmVDT2YuY2NOQOOivy5uNXUv1d+iHMaS31O0c/0fpz1dzOacZ6Yw1qMq1ty53mX491bdjoFxO6CPX878AmTM85BDpst8AXa/S2JufHpe9ZcSj3wo5eAJO+bAAL/Lq3ThWqo+COxmZaq6AsVpexvU3PxKRWh49HIiXLDz3mr5NGL295/EGhWnziF0MgE1UtLsBOgD2ZCiYllTRwChCzNbkgEilVJriC70Tlfhvivm5BosyA/2pcsMx3udjon+8q659cFADOFlB2g+UUWrogbFPJEQSCFkA2lhHLiQhUiC9+rP/3OvxJ+7Gm6QjiMXbY1GDlrm17NxIdIIPEOgp8/e24n32VmKgEmEfgBjLPqZOIaE65zHFDYzWKM16JX9KZjoZppxUyc8z0rjDRZfTYYKZ+/H4GLSbojugSh4hpaO4SWormDBILuxamptIpzSpBh9Y229Flg9LUGDTFigEl+fJlubHhNVIIVncWDskz+QYiIJTB/8qJC2zrlvSn4I8trO8Z/n8wyFUU=
before_install:
- npm install -g vsce@latest
install:
- npm install
script:
- npm run lint
- npm test --prefix server
- npm run compile
- cd client && vsce package -o vscode-sysl-$TRAVIS_TAG.vsix
deploy:
  provider: script
  skip_cleanup: true
  script: vsce publish -p $PUBLISH_TOKEN --packagePath vscode-sysl-$TRAVIS_TAG.vsix
  on:
    repo: anz-bank/vscode-sysl
    tags: true
    condition: "$TRAVIS_NODE_VERSION = 10.0"
