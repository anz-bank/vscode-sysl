language: node_js
sudo: false
node_js:
- '10.0'
env:
  global:
  - secure: gyB662wU+H3zs1mVcfHRl6USCxJzgb98jd1Idy2ocnZKyJMnSDsfmeq0bPB4PiVklEFZHusbDvjcj3bwDYzaOVGgEE3ROsJCLhC7nKuRBDD3x1gX3tFGzwzGuSvpG5042k27V5wTkr76IUUci8f5dIR+viUmuihZ5PTvoUSZ+LxLbQxSp6Qm1jEjXvNXsmPjMOlI5sz/DklGXSTrpM4KrxQZNtmEF74JtBtkrsCkehsg1SJBe4adVh2KjI7O0kNyb1OfC/Z2FSHoU0lfb7o2opK+lbD0kskjaUZ5C9fyI/UjkKNeDARVCfWKePNLHLZFK33Cfi7vw6HF+0dRmuywIjtFKJbekljQY0aPFkefRMjQz4OK5k9tHxEgMOmysS/iVvkAmRSI1f1oGlI7IIM1lDy9hb2TC6H/hcQttq5aNEtSikYNJ2hCbGsZE1vaPT3HR4cB1yfHbqG4XoDuzyGQd6MWKmEUHbQkza38b4SqaWkiT2VETaPQbpRq0+qgk2ROjQqCQgPc4+urfuvT4Y/ow5F+sRLTAnZTDvBopNu9OZufoVLNTC6RdIbYb81Lsr7ghrnJo40xSVrU36Nzeu6SLY6PO6SfPS3emzAm2OI1hDRLrRlrXIdJ0Tr3JJxeeCBemjh+7QdEz0EM+aAHBanaerRllmMF2saJoCdo9Jo0KM0=
before_install:
- npm install -g vsce@latest
install:
- npm install
script:
- npm run lint
- npm test --prefix server
- npm run compile
- cd client && vsce package -o vscode-sysl-$TRAVIS_TAG.vsix
deploy:
  provider: script
  skip_cleanup: true
  script: vsce publish -p $PUBLISH_TOKEN --packagePath vscode-sysl-$TRAVIS_TAG.vsix
  on:
    repo: anz-bank/vscode-sysl
    tags: true
    condition: "$TRAVIS_NODE_VERSION = 10.0"
