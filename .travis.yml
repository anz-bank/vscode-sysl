language: node_js
sudo: false
node_js:
- '10.0'
env:
  global:
  - secure: sL7/gRKg5+WyHXaToXuWc/up9+ds0WcWJIP0mEm3h2M177nkKEBiuGqlCll7i2pOfGhMMSZQSJSoM3L2IC2OfZVffvoDvuaof523+okIoJOeL1rwENAhJyc/eN3m6TtZvEJ5hTzZ22JqG5TVbI+yp6iBU0/ZUFWN7HjQGx9A5mfN8f6bngt53kQ0YyPflXjBh414glXEpCvhal0ujoepsxs+zbkwnfZZDxgXMYqzyETUTdIgP6Ssv8b+Ov3x2WRqlpzq8x9oLKegDJ0YI5EOIb6gmW9dHIlPxukye8NddNL6j1IKiMPGtpw+vTQcZUlBrKkqmfN3Qr0L2V/bhqqffymwnok3B7C7mK12j///74r9TkIOWiU+NS2DZqkH5sc6utgldjhtPH2Fpss2aTINeisl7hJQxVmUp9VN0+eplrLrhPBSi65/fZeshwEy4oUBuWL20nnSTcGf2/44nXwVDJMrLoOgDlrEo527goQ3XJB4RX31ckdQf/pOWSVL/6OmNiBGL2po9zPTRdpn3HnICKSSC/9su8Q+MG+QW9oGi0ZRcPcBaukwz3GMUa5keCXqFjMyJUVyM4m4x4JG6GJLupo7ftseY+ArpWAnhT+krQlX99rfuvbRlx9HsbavZFRe/y4eNpyOAR7TCm/dMAIJTERCDcVDh5m5Rg38Y4wRgg0=
before_install:
- npm install -g vsce@latest
install:
- npm install
script:
- npm run lint
- npm test --prefix server
- npm run compile
- cd client && vsce package -o vscode-sysl-$TRAVIS_TAG.vsix
deploy:
  provider: script
  skip_cleanup: true
  script: vsce publish -p $PUBLISH_TOKEN --packagePath vscode-sysl-$TRAVIS_TAG.vsix
  on:
    repo: anz-bank/vscode-sysl
    tags: true
    condition: "$TRAVIS_NODE_VERSION = 10.0"
