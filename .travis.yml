language: node_js
sudo: false
node_js:
- '10.0'
env:
  global:
  - secure: G3LkLnNvfhHqVLkt/6avMIRI/1NRbd5zCMAQ/0WU/rhjtpH5ULfq0T33zJloaOwXof5DkAqrx9Dlci8esJPPvkOYaPiEjdCOSsVNi5B9lhLt+ZJgLcTHah40MSBc8zM8Zt7h7po3JrdSlgtt5W+XyupIAfKpyHOHzSLhduaWbSLnI4yEjBT0qSSqXtWuaY7fFxOVSZStXWXcp5uD8w6aZFN1i/2fnN561O52RI/YEdqUxoSJ+iszjNNFSHpfIyyUGxtWRI3YvFY4n6LKvbKc52YuZOydg9HCUiLDIJ3Qxau1hP+nqVDuIpLwmTy3s21ndyWY9d4N+RiwANmax+TdolajpTTsdMMjmBdl17rNSR8E/QAEx2YenbT/cOxfFbIpk9mgdsnQmEse3Ou1NZWmXBdxe1OdwKTPBzn4n4pVgDYvx/tY9/+1nLdZjQczGvtGffU4VXCJL8nY1+FsMrgbBKS7Ed3wfcyQtVbp88arD85nCFA1ocojAxU24zWOUFmrhPXMFoc0L19ljV/1iwYktqgmIZen7KPv2H43oj8NNs204j59FaSRngOG0kDGlx3BlzmcXPXs9ECiTXDmWRsyO+49awThcpX0HKxwtel/Nz8IfvxKHW0vQN99Huhg2gTjegggtid4hAZJlEQzT6RY+NXr9I11vo6RILPH5fq/B48=
before_install:
- npm install -g vsce@latest
install:
- npm install
script:
- npm run lint
- npm test --prefix server
- npm run compile
- cd client && vsce package -o vscode-sysl-$TRAVIS_TAG.vsix
deploy:
  provider: script
  skip_cleanup: true
  script: vsce publish -p $PUBLISH_TOKEN --packagePath vscode-sysl-$TRAVIS_TAG.vsix
  on:
    repo: anz-bank/vscode-sysl
    tags: true
    condition: "$TRAVIS_NODE_VERSION = 10.0"
